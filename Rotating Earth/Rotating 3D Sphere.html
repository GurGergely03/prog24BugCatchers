<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Rotating 3D Sphere with Three.js</title>
	 <style>
	     /* Remove default margin from the body */
        body { margin: 0; } 
        /* Make the canvas element block-level */
        canvas { display: block; } 
        </style>
    </head>

<body>
	<script src="imgchange.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
	<script>	
	fetch('/save-image', {
        method: 'POST',
        body: JSON.stringify({ image: dataURL }),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(response => response.text())
      .then(result => console.log(result))
      .catch(error => console.error('Error:', error));
	// Set up the scene, camera, and renderer
	const scene = new THREE.Scene(); 
    // Create a perspective camera with a 75 degree field of view, 
    // aspect ratio based on window size, near clipping plane 
    // at 0.1 units, and far clipping plane at 1000 units
	const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000); 
	const renderer = new THREE.WebGLRenderer(); // Create a WebGL renderer
    // Set the renderer size to match the window size
	renderer.setSize(window.innerWidth, window.innerHeight); 
    // Append the renderer's canvas element to the document body
	document.body.appendChild(renderer.domElement); 
	
     // Create an ambient light with white color and intensity 0.5
	const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
    // Add the ambient light to the scene
	scene.add(ambientLight); 
	
    // Create a directional light with white color and intensity 0.5
	const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5); 
    // Set the position of the directional light and normalize its direction vector
	directionalLight.position.set(1, 1, 1).normalize(); 
    // Add the directional light to the scene
	scene.add(directionalLight); 

    // Create a sphere geometry with a radius of 2 units and high vertex density
	const geometry = new THREE.SphereBufferGeometry(2, 64, 64); 
     // Create a texture loader
	const textureLoader = new THREE.TextureLoader();
    // Load a texture from the internet
	const texture = textureLoader.load('earth.jpg'); 
	// Create a Phong material with the loaded texture
    const material = new THREE.MeshPhongMaterial({
		map: texture
	}); 

    // Create a mesh using the geometry and material
	const sphere = new THREE.Mesh(geometry, material); 
    // Add the sphere to the scene
	scene.add(sphere); 
	// Set the camera's position along the z-axis to 5 units

	camera.position.z = 5;
	// Define the animation loop
    // Create a function named animate
	const animate = function() { 
		// Request the next animation frame, recursively calling the animate function
		requestAnimationFrame(animate);
		// Increment the rotation of the sphere around the y-axis by 0.002 radians
		sphere.rotation.x = 0.2;
		sphere.rotation.y += 0.002;
		// Render the scene using the specified camera and renderer
		renderer.render(scene, camera);
	};
	// Call the animate function to start the animation loop
	animate();
	
	</script>
</body>

</html>